@{
    ViewData["Title"] = "Employees Page";
}
@model Employee


<h2 class="mb-2">@ViewBag.Action Employee</h2>

<!--This will post employee and (tempPassword if it is Edit Action) -->
<form method="post" asp-action=@ViewBag.Action>
    <!--hidden field to post back to contoller without changing them-->
    <input type="hidden" asp-for="EmployeeID" />

    <!--alert user if fields are not ok-->
    <div asp-validation-summary=All class=" text-danger"></div>
    <div class="mb-3">
        <label asp-for="FirstName" class="form-label">First Name</label>
        <input asp-for="FirstName" class="form-control">
    </div>
    <div class="mb-3">
        <label asp-for="LastName" class="form-label">Last Name</label>
        <input asp-for="LastName" class="form-control">
    </div>
    <div class="mb-3">
        <label asp-for="RoleId" class="form-label">Role</label>
        
        <!--if it is Edit Action then show the current Role on the top -->
        <select asp-for="RoleId" class="form-select">
            @if (ViewBag.Action == "Edit")
            {
                <option value=@Model.RoleId>@ViewBag.Roles[Model.RoleId-1].RoleName</option>
                @foreach (Role r in ViewBag.Roles)
                {
                    if (r.RoleID != Model.RoleId)
                    {
                        <option value=@r.RoleID>@r.RoleName</option>
                    }
                }
            }
            else 
            {
                <!--if it is Add Action, then shows them in default order-->
                <option value="">Select Role</option>
                @foreach(Role r in ViewBag.Roles)
                {
                    <option value=@r.RoleID>@r.RoleName</option>
                }
            }
        </select>
    </div>
    
    <!--if it is Edit Action then save current password and usernaem in hidden input-->
    @if (ViewBag.Action == "Edit")
    {
        <input hidden asp-for="Password" type="text" class="form-control">
        <input hidden asp-for="UserName" type="text" class="form-control">

        <!--and show a new input called tempPassword. tempPassword will be posted to Edit action
            if left blank then user will keep current password
            otherwise will be prompted to change password when logging in using the new tempPassword
        -->
        <div class="mb-3">
            <label class="form-label">Temporary Password (Leave blank if you don't want to change password)</label>
            <input name="tempPassword" type="text" class="form-control">
        </div>
    }else{
        <!--if it is Add action then inform the General Manager that username will be auto generated
            Password field will set the password for employee
        -->
        <div class="mb-3">
            <label class="form-label">Username will be autogenerated</label>
        </div>
        <div class="mb-3">
            <label asp-for="Password" class="form-label">Temporary Password</label>
            <input asp-for="Password" type="text" class="form-control">
        </div>
    }
    <button type="submit" class="btn btn-primary">@ViewBag.Action</button>
    <a class="btn btn-primary" asp-contoller="Employee" asp-action="Search">Cancel</a>

</form>